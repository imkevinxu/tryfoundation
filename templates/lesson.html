{% extends "base.html" %}
{% block title %}{{ super() }}{% endblock %}
{% block meta_description %}{% endblock %}

{% block extra_head %}{% endblock %}

{% block content %}

<div id="lesson">
    <nav class="top-bar">
        <ul class="title-area">
            <li class="name">
                <h1><a href="{% url index %}">Try Foundation</a></h1>
            </li>
        </ul>

        <section class="top-bar-section">
            <ul class="right">
                <li class="has-form">
                    {% if request.user.is_authenticated() %}
                        <a href="{% url logout %}" class="button">Logout</a>
                    {% else %}
                        <a href="{% url login %}" class="button">Log In</a>
                    {% endif %}
                </li>
            </ul>
        </section>
    </nav>

    <div id="left">
        {% set html = '<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" href="foundation.css" />
</head>
<body>

</body>
</html>' %}


        <div id="editor">{{html}}</div>

    </div>

    <div id="right">
        <iframe id="preview"></iframe>

    </div>


</div>

{% endblock %}

{% block javascript %}

<script src="http://rawgithub.com/ajaxorg/ace-builds/master/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    var session = editor.getSession();

    editor.setTheme("ace/theme/tomorrow_night_eighties");
    session.setMode("ace/mode/html");
    session.setUseWrapMode(true);
    editor.setFontSize(20);
    session.on("change", function() {
        var html = session.getValue();
        var iframe = $('#preview')[0];
        iframe.contentWindow.document.open('text/html', 'replace');
        iframe.contentWindow.document.write(html);
        iframe.contentWindow.document.close();
        var iframeHead = $('#preview').contents().find('head');
        $(iframeHead).html('<link rel="stylesheet" href="{{ MEDIA_URL }}css/foundation.min.css">');
    });
</script>

{% endblock %}
